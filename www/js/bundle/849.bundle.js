"use strict";(self.webpackChunklzone_de=self.webpackChunklzone_de||[]).push([[849],{849:(e,t,s)=>{s.r(t),s.d(t,{FeedsView:()=>a});var r=s(779),i=s(217),n=s(218),u=s(808);class a{#e;#t;static#s=r.vs('\n        <h1>Folder "Feeds"</h1>\n    ');constructor(e){if(this.#e=e,document.location.hash.startsWith("#/-/Feeds/Add")){let e=document.location.search.split("url=")[1]||"unknown";e=decodeURIComponent(e),e=e.replace(/^web\+feed:/,""),this.#r(e)}else this.#i();navigator.registerProtocolHandler("web+feed","/?url=%s#/-/Feeds/Add")}async#i(){r.dN(this.#e,a.#s,{tree:n.f.root.children})}static#n=r.vs("\n        <h1>Adding new subscription</h1>\n\n\n        {{#if fetching}}\n            <p>\n                Searching for feed from URL: <span class='url'>{{url}}</span> ...\n            </p>\n        {{else}}\n            <input name='url' type='text' value='{{url}}' autofocus placeholder='Website or feed URL'/>\n            <input type='submit' value='Add'/>\n\n            {{#if result}}\n                <p>\n                    ✅ Successfully subscribed to feed: <a href='{{result}}'>{{result}}</a>.\n                </p>\n            {{/if}}\n            {{#if error}}\n                <p>\n                    <div>⛔ Error: {{error}}</div>\n                </p>\n            {{/if}}\n        {{/if}}\n    ");async#u(e){this.#t={...this.#t,...e},r.dN(this.#e,a.#n,this.#t),this.#e.querySelector("input[type=submit]")?.addEventListener("click",(e=>{e.preventDefault();const t=this.#e.querySelector("input[name=url]").value.trim();t?this.#r(t):this.#u({error:"Please provide a URL!"})}))}async#r(e){this.#u({fetching:!0,url:e});let t,s=[];-1==e.indexOf("://")&&(e="https://"+e),console.info(`Trying to subscribe to ${e}`);try{t=await fetch(e).then((e=>e.text()))}catch(t){return console.error("Error fetching URL %s",e,t),void this.#u({fetching:!1,error:"URL download failed!"})}try{(0,u.S)(t,e)?s.push(e):s=(0,u.Z)(t,e)}catch(e){return void this.#u({fetching:!1,error:"Parsing failed!"})}if(s.length>0)return i.r.dispatch("feedreader:addFeed",{title:"New Feed",source:s[0]}),void this.#u({fetching:!1,result:s[0],error:null});this.#u({fetching:!1,error:"Feed auto discovery failed!"})}}}}]);