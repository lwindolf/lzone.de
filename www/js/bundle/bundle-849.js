"use strict";(self.webpackChunklzone_de=self.webpackChunklzone_de||[]).push([[849],{849:(e,t,r)=>{r.r(t),r.d(t,{FeedsView:()=>o});var s=r(779),n=r(470),i=r(217),u=r(753),d=r(800);class o{#e;#t;static#r=s.vs("\n        <h1>Folder \"Feeds\"</h1>\n\n        <h2>Subscriptions</h2>\n\n        <p>\n            <div id='installedSections'>\n            {{#each tree }}\n                <div class='installed'>\n                    <button data-action='feedreader:removeNode' data-id='{{ this.id }}'>Remove</button>\n                    <a href=\"{{ this.orig_source }}\">{{ this.title }}</a>\n                </div>\n            {{else}}\n                You currently have no subscriptions. Try adding one below.\n            {{/each}}\n            </div>\n        </p>\n\n        <h2>Add subscription</h2>\n        \n        <p>\n            <div id='customInstall'>\n                <div>\n                        <input type='text' width='100%' id='url' placeholder='URL'/>\n                        <button>Subscribe</button>\n                </div>\n                {{#if error}}\n                    <div>Error: {{error}}</div>\n                {{/if}}\n            </div>\n        </p>\n\n        <p>Or discover feeds from the different sources...</p>\n\n        <button class=\"btn\" onclick=\"location.href='#/-/Discover'\">Discover Feeds</button>\n    ");constructor(e){if(this.#e=e,document.location.hash.startsWith("#/-/Feeds/Add")){let e=document.location.search.split("url=")[1]||"unknown";e=decodeURIComponent(e),e=e.replace(/^web\+feed:/,""),this.#s(e)}else this.#n();navigator.registerProtocolHandler("web+feed","/?url=%s#/-/Feeds/Add"),document.addEventListener("nodeRemoved",(()=>{this.#n()}))}async#n(){s.dN(this.#e,o.#r,{tree:u.f.root.children}),n.Ng("click","#customInstall button",(()=>{const e=document.querySelector("#customInstall input#url").value.trim();this.#s(e)}))}static#i=s.vs("\n        <h1>Adding new subscription</h1>\n\n\n        {{#if fetching}}\n            <p>\n                Searching for feed from URL: <span class='url'>{{url}}</span> ...\n            </p>\n        {{else}}\n            <input name='url' type='text' value='{{url}}' autofocus placeholder='Website or feed URL'/>\n            <input type='submit' value='Add'/>\n\n            {{#if result}}\n                <p>\n                    ✅ Successfully subscribed to feed: <a href='{{result}}'>{{result}}</a>.\n                </p>\n            {{/if}}\n            {{#if error}}\n                <p>\n                    <div>⛔ Error: {{error}}</div>\n                </p>\n            {{/if}}\n        {{/if}}\n    ");async#u(e){this.#t={...this.#t,...e},s.dN(this.#e,o.#i,this.#t),this.#e.querySelector("input[type=submit]")?.addEventListener("click",(e=>{e.preventDefault();const t=this.#e.querySelector("input[name=url]").value.trim();t?this.#s(t):this.#u({error:"Please provide a URL!"})}))}async#s(e){this.#u({fetching:!0,url:e});let t,r=[];-1==e.indexOf("://")&&(e="https://"+e),console.info(`Trying to subscribe to ${e}`);try{t=await fetch(e).then((e=>e.text()))}catch(t){return console.error("Error fetching URL %s",e,t),void this.#u({fetching:!1,error:"URL download failed!"})}try{(0,d.S)(t,e)?r.push(e):r=(0,d.Z)(t,e)}catch(e){return void this.#u({fetching:!1,error:"Parsing failed!"})}if(r.length>0)return i.r.dispatch("feedreader:addFeed",{title:"New Feed",source:r[0]}),void this.#u({fetching:!1,result:r[0],error:null});this.#u({fetching:!1,error:"Feed auto discovery failed!"})}}}}]);