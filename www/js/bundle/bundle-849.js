"use strict";(self.webpackChunklzone_de=self.webpackChunklzone_de||[]).push([[849],{849:(e,t,s)=>{s.a(e,(async(e,n)=>{try{s.r(t),s.d(t,{FeedsView:()=>l});var r=s(779),i=s(470),u=s(217),c=s(753),a=s(800),d=s(846),o=e([c]);c=(o.then?(await o)():o)[0];class l{#e;#t;static#s=r.vs("\n        <h1>Folder \"Feeds\"</h1>\n\n        <h2>Subscriptions</h2>\n\n        <p>\n            <div id='installedSections'>\n            {{#each tree }}\n                <div class='installed'>\n                    <button data-id='{{ this.id }}'>Remove</button>\n                    <a href=\"{{ this.orig_source }}\">{{ this.title }}</a>\n                </div>\n            {{else}}\n                You currently have no subscriptions. Try adding one below.\n            {{/each}}\n            </div>\n        </p>\n\n        <h2>Add subscription</h2>\n        \n        <p>\n            <div id='customInstall'>\n                <div>\n                        <input type='text' width='100%' id='url' placeholder='URL'/>\n                        <button>Subscribe</button>\n                </div>\n                {{#if error}}\n                    <div>Error: {{error}}</div>\n                {{/if}}\n            </div>\n        </p>\n\n        <p>Or discover feeds from the different sources...</p>\n\n        <button class=\"btn\" onclick=\"location.href='#/-/Discover'\">Discover Feeds</button>\n    ");constructor(e){if(this.#e=e,document.location.hash.startsWith("#/-/Feeds/Add")){let e=document.location.search.split("url=")[1]||"unknown";e=decodeURIComponent(e),e=e.replace(/^web\+feed:/,""),this.#n(e)}else this.#r();navigator.registerProtocolHandler("web+feed","/?url=%s#/-/Feeds/Add")}async#r(){r.dN(this.#e,l.#s,{tree:c.f.root.children}),i.Ng("click","#customInstall button",(()=>{const e=document.querySelector("#customInstall input#url").value.trim();this.#n(e)})),i.Ng("click","#installedSections .installed button",(async e=>{c.f.remove(parseInt(e.getAttribute("data-id"),10)),this.#r()}))}static#i=r.vs("\n        <h1>Adding new subscription</h1>\n\n\n        {{#if fetching}}\n            <p>\n                Searching for feed from URL: <span class='url'>{{url}}</span> ...\n            </p>\n        {{else}}\n            <input name='url' type='text' value='{{url}}' autofocus placeholder='Website or feed URL'/>\n            <input type='submit' value='Add'/>\n\n            {{#if result}}\n                <p>\n                    ✅ Successfully subscribed to feed: <a href='{{result}}'>{{result}}</a>.\n                </p>\n            {{/if}}\n            {{#if error}}\n                <p>\n                    <div>⛔ Error: {{error}}</div>\n                </p>\n            {{/if}}\n        {{/if}}\n    ");async#u(e){this.#t={...this.#t,...e},r.dN(this.#e,l.#i,this.#t),this.#e.querySelector("input[type=submit]")?.addEventListener("click",(e=>{e.preventDefault();const t=this.#e.querySelector("input[name=url]").value.trim();t?this.#n(t):this.#u({error:"Please provide a URL!"})}))}async#n(e){this.#u({fetching:!0,url:e});let t,s=[];-1==e.indexOf("://")&&(e="https://"+e),console.info(`Trying to subscribe to ${e}`);try{t=await(0,d.F)(e).then((e=>e.text()))}catch(t){return console.error("Error fetching URL %s",e,t),void this.#u({fetching:!1,error:"URL download failed!"})}try{(0,a.S)(t,e)?s.push(e):s=(0,a.Z)(t,e)}catch(e){return void this.#u({fetching:!1,error:"Parsing failed!"})}if(s.length>0)return u.r.dispatch("feedreader:addFeed",{title:"New Feed",source:s[0]}),void this.#u({fetching:!1,result:s[0],error:null});this.#u({fetching:!1,error:"Feed auto discovery failed!"})}}n()}catch(e){n(e)}}))}}]);