"use strict";(self.webpackChunklzone_de=self.webpackChunklzone_de||[]).push([[491],{491:(e,t,n)=>{n.r(t),n.d(t,{SettingsView:()=>s});var a=n(240),o=n(551),i=n(779);class s{constructor(e,t){s.#e(e,t),document.addEventListener("settings-changed",(t=>s.#t(e,t.detail.name)))}static async#t(e,t){if(console.log(`SettingsView: Updating ${t}`),!e.querySelector(`select[options="${t}"]`))return;const n=await o.w.get(t);void 0!==n&&i.XX(`select[options="${t}"]`,i.vs('\n                {{#each values}}\n                <option value="{{this}}">{{this}}</option>\n                {{/each}}\n            '),{values:n})}static async#n(e){e.querySelectorAll('input[type="checkbox"]').forEach((async e=>{!0===await o.w.get(e.name)&&(e.checked=!0),e.addEventListener("change",(e=>{o.w.set(e.target.name,!!e.target.checked,!0)}))})),e.querySelectorAll('input[type="text"]').forEach((async e=>{const t=await o.w.get(e.name);void 0!==t&&(e.value=t),e.addEventListener("change",(e=>{o.w.set(e.target.name,e.target.value,!0)}))})),e.querySelectorAll("select").forEach((async t=>{const n=await o.w.get(t.name);void 0!==n&&(t.value=n),"true"===t.dataset.updateVisibility&&s.#a(e,t.name),t.addEventListener("change",(n=>{"true"===t.dataset.updateVisibility&&s.#a(e,n.target.name),o.w.set(n.target.name,n.target.value,!0)}))}))}static#a(e,t){const n=e.querySelector(`select[name="${t}"]`)?.value;n&&e.querySelectorAll(`[${t}]`).forEach((e=>{e.getAttribute(t)===n?e.classList.remove("hidden"):e.classList.add("hidden")}))}static async#o(){try{await a.r.updateOllamaModelList(),document.getElementById("ollamaTestResult").innerText="✅ Works!"}catch(e){document.getElementById("ollamaTestResult").innerText=`⛔ Failed (${e})!`}}static async#e(e,t){const n=t.split("/").pop();if(t.startsWith("-/Settings/Tools/"))e.innerHTML=`<h1>Settings - ${n}</h1> ${window.Config.toolboxComponents[n].settings}`;else{if("-/Settings/Tools"===t)i.dN(e,i.vs('\n                <h1>Settings - Tools</h1>\n\n                {{#each names}}\n                <div class="tool">\n                    <input type="checkbox" name="toolEnabled:::{{.}}" {{#ifTrue enabled}}checked{{/ifTrue}}>\n                    {{.}} (<a href="#/-/Settings/Tools/{{.}}">Settings</a>)\n                </div>\n                {{/each}}\n            '),{names:Object.keys(window.Config.toolboxComponents)});else if("-/Settings"===t){const t=await o.w.get("ollamaModels",[]);i.dN(e,i.vs(`\n                <h1>Global Settings</h1>\n\n                <h3>CORS Proxy</h3>\n\n                <p>\n                    <input type="checkbox" name="allowCorsProxy">\n                    Always allow using the CORS Proxy <code>${window.Config.corsProxy}</code>\n                </p>\n\n                <h3>Feed Reader</h3>\n\n                <p>\n                    <input name="feedreader:::maxItems" type="number" value="100" size="1" min="1">\n                    <label for="feedreader:::maxItems">Maximum number of items to cache per feed</label>\n                </p>\n                <p>\n                    <input type="checkbox" name="feedreader:::updateAllOnStartup"> Automatically update out-dated feeds on startup\n                </p>\n                <p>\n                    Default update interval <input name="feedreader:::refreshInterval" type="number" value="24" size="1" min="1"> \n                    <select name="feedreader:::refreshIntervalUnit">\n                        <option value="hours">hour(s)</option>\n                        <option value="days">day(s)</option>\n                    </select>\n                </p>\n\n                <h3>Configure Chat Bot</h3>\n\n                <p>\n                    Mode <select name="chatType" data-update-visibility="true">\n                        <option value="none">Disabled</option>\n                        <option value="ollama">ollama API</option>\n                        <option value="huggingFace">HuggingFace</option>\n                    </select>\n                </p>\n\n                <div chatType="huggingFace" class="hidden">\n                    <p>\n                        Select a public <a href="https://huggingface.co/">HuggingFace</a> space \n                        to use for chat. The listed spaces do not require authentication and \n                        might have usage quota. Do not use those spaces for sensitive prompts.\n                        Consider all prompts public and your data processed by 3rd parties!\n                    </p>\n\n                    <table>\n                    <tr>\n                        <td>\n                            Space\n                        </td>\n                        <td>\n                            <select name="huggingFaceModel">\n                                {{#each hfModels}}\n                                <option value="{{this}}">{{this}}</option>\n                                {{/each}}\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            HuggingFace Token\n                        </td>\n                        <td>\n                            <input type="text" name="huggingFaceToken" value="{{huggingFaceToken}}" width="100%">\n                        </td>\n                    </tr>\n                    </table>\n                </div>\n\n                <div chatType="ollama" class="hidden">\n                    <table>\n                        <tr>\n                            <td>\n                                Endpoint\n                            </td>\n                            <td>\n                                <input type="text" name="ollamaEndpoint" value="http://localhost:11434"/>\n                                <span id="ollamaTestResult"></span>\n                                <br/>\n                                Hint: local ollama default endpoint is <code>http://localhost:11434</code>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                Model\n                            </td>\n                            <td>\n                                <select name="ollamaModel" options="ollamaModels">\n                                    {{#each ollamaModels}}\n                                    <option value="{{this}}">{{this}}</option>\n                                    {{/each}}\n                                </select>\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n\n                <h3>App Cache</h3>\n\n                <p>Clear the app cache. This does <b>not</b> any delete content. Try this when the app does not work!</p>\n                <div>\n                    <button id="resetPwaCache">Reset PWA cache</button>\n                </div>\n                <p>Current worker version: ${await new Promise((e=>{if("serviceWorker"in navigator&&navigator.serviceWorker.controller){const t=new MessageChannel;t.port1.onmessage=t=>{e(t.data)},navigator.serviceWorker.controller.postMessage("version",[t.port2])}else e("N/A")}))}</p>\n\n                <h3>Sidebar Tools</h3>\n                \n                <p>\n                    <button onclick='document.location.hash="/-/Settings/Tools"'>Configure</button>\n                </p>\n            `),{hfModels:window.Config.chatBotModels,huggingFaceToken:await o.w.get("huggingFaceToken",""),ollamaModels:t,updateRefreshInterval:await o.w.get("feedreader:::refreshInterval",24),updateRefreshIntervalUnit:await o.w.get("feedreader:::refreshIntervalUnit","hours")}),e.querySelector('input[name="ollamaEndpoint"]').addEventListener("change",(()=>this.#o(e))),0===t.length&&this.#o(),e.querySelector("#resetPwaCache").addEventListener("click",(()=>{confirm("Are you sure you want to reset the PWA cache? This will reload the app.")&&("serviceWorker"in navigator&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage({action:"clearCache"}):console.error("Service worker is not available or not controlling the page."))}))}else e.innerHTML="ERROR: Unknown settings path";s.#n(e)}}}}}]);